#!/usr/bin/env bash

function get_action() {
	local actions="lock\nlogout\nreboot\nshutdown"
	echo -e "$actions" | rofi -dmenu
}

function action_confirm() {
	local actions="yes\nno"
	echo -e "$actions" | rofi -dmenu -i -p "Are you sure you want to $1?"
}

function action_lock() {
	i3lock -ntefi /usr/share/backgrounds/wallhaven-farcry5-lock.png
}

function action_logout() {
	local confirm

	confirm="$(action_confirm $1)"
	if [[ "$confirm" == "yes" ]]; then
		i3-msg exit
	fi
}

function action_reboot() {
	local confirm

	confirm="$(action_confirm $1)"
	if [[ "$confirm" == "yes" ]]; then
		systemctl reboot
	fi
}

function action_shutdown() {
	local confirm

	confirm="$(action_confirm $1)"
	if [[ "$confirm" == "yes" ]]; then
		systemctl poweroff
	fi
}

function process_action() {
	case "$1" in
		"lock") action_lock;;
		"logout") action_logout "$1";;
		"reboot") action_reboot "$1";;
		"shutdown") action_shutdown "$1";;
	esac
}

function main() {
	process_action "$(get_action)"
}

main "$@"
