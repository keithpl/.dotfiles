# vi: ft=zsh
# Do not load these options if the session is not interactive.
if [[ $- != *i* ]]; then
	return 1
fi

bindkey -e
bindkey '^[[Z' end-of-line

zstyle :compinstall filename '$ZDOTDIR/.zshrc'

autoload -Uz compinit && compinit
autoload -Uz colors && colors
autoload -Uz promptinit && promptinit

setopt glob_dots

export LESSHISTFILE=-
export MANPAGER="sh -c 'col -bx | bat -l man -p'"

alias vim='nvim'
alias vimdiff='nvim -d -c "tabdo windo set nolist"'
alias diff='diff --color=auto'
alias grep='grep --color=auto'
alias history='history -i'
alias tb='nc termbin.com 9999'
alias ls='exa -g --group-directories-first'

{{- if eq .chezmoi.os "linux" }}
alias ip='ip -color=auto'
alias dmesg='dmesg --color=always'
alias weechat='firejail --private=${HOME}/jails/weechat -- weechat'
{{- else if eq .chezmoi.os "darwin" }}
alias brewup='brew cleanup; brew doctor && brew update && brew upgrade'
{{- end }}

source "$ZDOTDIR/history.zsh"
source "$ZDOTDIR/zinit-install.zsh"

zinit ice compile'(pure|async).zsh' pick'async.zsh' src'pure.zsh'
zinit light sindresorhus/pure
zinit light zdharma-continuum/fast-syntax-highlighting
zinit light zsh-users/zsh-autosuggestions

{{ if eq .chezmoi.os "darwin" -}}
export PATH="/opt/homebrew/bin:/opt/homebrew/sbin:$PATH"

{{ end -}}

# Launch tmux if not already running within tmux.
if command -v tmux &>/dev/null && [[ -z "$TMUX" ]]; then
	exec tmux
fi
